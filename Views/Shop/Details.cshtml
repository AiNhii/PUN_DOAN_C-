@using comestic_csharp.Areas.Identity.Data
@model comestic_csharp.Models.Product

@{

  ViewData["Title"] = "Details";

  Layout = "/Views/Shared/_MainLayout.cshtml";

  ShopDbContext context = new ShopDbContext();

  var comment = context.Productreviews.Where(p => p.ProductId == @Model.Id && p.Status == "active");
}
<link rel="stylesheet" href="/shop/details.css" />

<!-- Breadcrumbs -->

<div class="title-page">
  <div class="container">
    <div class="row">
      <div class="col-md-6 inner-title-page">
        <div class="page-header">
          <div class="page-block">
            <div class="row align-items-center" id="title">
              <div class="section-title">
                <h2>Pun Shop</h2>
              </div>
              <ul class="breadcrumb">
                <li class="breadcrumb-item"><a class="pc-link" asp-action="index" asp-controller="Home">Home</a></li>
                <li class="breadcrumb-item"><a class="pc-link" asp-action="index" asp-controller="Shop">Type of
                    Product</a>
                </li>
                <li class="breadcrumb-item">Product</li>
              </ul>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</div>
@* <div class="page-header">
  <div class="page-block">
  <div class="row align-items-center">
  <div class="col-md-12">
  <ul class="breadcrumb">
  <li class="breadcrumb-item"><a class="pc-link" asp-action="index" asp-controller="Home">Home</a></li>
  <li class="breadcrumb-item"><a class="pc-link" asp-action="index" asp-controller="Shop">Type of
  Product</a>
  </li>
  <li class="breadcrumb-item">Product</li>
  </ul>
  </div>
  </div>
  </div>
  </div> *@
<!-- End Breadcrumbs -->

<!-- Shop Single -->

<section class="shop single section">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="row">

          <div class="col-lg-6 col-12">
            <div class="d-flex flex-column justify-content-center">
              <!-- Product Slider -->
              <div class="product-gallery">
                <!-- Images slider -->
                <div class="flexslider-thumbnails">
                  <ul class="slides">
                    <li data-thumb="Cocoa-Coffee-Body-Scrub" rel="adjustX:10, adjustY:">
                      <span class="wish-icon"><i class="fa fa-heart-o"></i></span>
                      <img src="/storage/@Html.DisplayFor(model => model.Photo1)" alt="" id="main_product_image"
                        width="150" />
                    </li>
                  </ul>
                  <div class="thumbnail_images">
                    <ul id="thumbnail">
                      <li>
                        <img onclick="changeImage(this)" src="/storage/@Html.DisplayFor(model => model.Photo1)"
                          width="70" />
                      </li>
                      <li>
                        <img onclick="changeImage(this)" src="/storage/@Html.DisplayFor(model => model.Photo2)"
                          width="70" />
                      </li>
                      <li>
                        <img onclick="changeImage(this)" src="/storage/@Html.DisplayFor(model => model.Photo3)"
                          width="70" />
                      </li>
                      <li>
                        <img onclick="changeImage(this)" src="/storage/@Html.DisplayFor(model => model.Photo4)"
                          width="70" />
                      </li>
                    </ul>
                  </div>
                </div>
                <!-- End Images slider -->
              </div>
              <!-- End Product slider -->
            </div>
          </div>

          <div class="col-lg-6 col-12">
            <div class="product-des">
              <!-- Description -->
              <div class="short">
                <h4>@Html.DisplayFor(model => model.Title)</h4>
                <div class="rating-main text-left">

                  <a href="#" class="total-review">(<span> @comment.Count() </span>) Review</a>
                </div>
                <p class="price">
                  <s> @Html.DisplayFor(model => model.Price)</s><span class="discount">750 000</span>
                </p>

                <p>
                  <span class="description" style="
                          font-family: 'Open Sans', Arial, sans-serif;
                          font-size: 14px;
                          text-align: justify;
                        ">Mô tả ngắn gọn : @Html.DisplayFor(model => model.Summary)</span><br />
                </p>
              </div>
              <!--/ End Description -->
              <!-- Product Buy -->
              <div class="product-buy">
                <p class="cat" style="font-weight: bold">
                  Category :<a href="#">Category</a>
                </p>
                <p class="cat mt-1" style="font-weight: bold">
                  Sub Category :<a href="#">sub_category</a>
                </p>
                @* <p class="availability" style="font-weight: bold">
                  Stock : <span class="badge badge-success"> @Html.DisplayFor(model => model.Stock) </span>
                  </p> *@
                <form action="#" method="POST" class="
                  d-flex
                  flex-row
                  align-items-center
                  justify-center-between
                  ">
                  @* <div class="quantity">
                    <h6 style="font-weight: bold">Quantity :</h6>
                    <!-- Input Order -->
                    <div class="input-group">
                    <div class="button minus">
                    <button type="button" class="btn btn-primary btn-number" disabled="disabled" data-type="minus"
                    data-field="quant[1]">
                    <i class="ti-minus"></i>
                    </button>
                    </div>
                    <input type="hidden" name="slug" value="slug" />
                    <input type="text" name="quant[1]" class="input-number" data-min="1" data-max="1000" value="1"
                    id="quantity" />
                    <div class="button plus">
                    <button type="button" class="btn btn-primary btn-number" data-type="plus" data-field="quant[1]">
                    <i class="ti-plus"></i>
                    </button>
                    </div>
                    </div>
                    <!--/ End Input Order -->
                    </div> *@
                  <div class="add-to-cart d-flex flex-row">

                    <button type="submit" class="btn" asp-action="AddToCart" asp-controller="ShoppingCart"
                      asp-route-id="@Model.Id">Add to cart</button>
                    <a class="btn btn-info btn-add-to-cart" asp-action="AddToCart" asp-controller="ShoppingCart"
                      asp-route-id="@Model.Id"><i class="fa fa-shopping-cart"></i></a>
                  </div>
                </form>

              </div>
              <!--/ End Product Buy -->
            </div>
          </div>
        </div>

        <div class="row p-5">
          <div class="col-12">
            <div class="product-info">
              <div class="nav-main">
                <!-- Tab Nav -->
                <ul class="nav nav-tabs" id="myTab" role="tablist">
                  <li class="nav-item">
                    <a class="nav-link active" data-toggle="tab" href="#description" role="tab">Description</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#reviews" role="tab">Reviews</a>
                  </li>
                </ul>
                <!--/ End Tab Nav -->
              </div>
              <div class="tab-content" id="myTabContent">
                <!-- Description Tab -->
                <div class="tab-pane fade show active" id="description" role="tabpanel">
                  <div class="tab-single">
                    <div class="row">
                      <div class="col-12">
                        <div class="single-des">
                          <p></p>
                          <!--NHAP NOI DUNG MO TA-->
                          <h3 style="
                                  margin: 15px 0px;
                                  padding: 0px;
                                  font-weight: 700;
                                  font-size: 14px;
                                  font-family: 'Open Sans', Arial, sans-serif;
                                ">
                            The standard Lorem Ipsum passage, used since the
                            1500s
                          </h3>
                          <p style="
                                  margin-right: 0px;
                                  margin-bottom: 15px;
                                  margin-left: 0px;
                                  padding: 0px;
                                  text-align: justify;
                                  font-family: 'Open Sans', Arial, sans-serif;
                                  font-size: 14px;
                                ">
                            "Lorem ipsum dolor sit amet, consectetur
                            adipiscing elit, sed do eiusmod tempor
                            incididunt ut labore et dolore magna aliqua. Ut
                            enim ad minim veniam, quis nostrud exercitation
                            ullamco laboris nisi ut aliquip ex ea commodo
                            consequat. Duis aute irure dolor in
                            reprehenderit in voluptate velit esse cillum
                            dolore eu fugiat nulla pariatur. Excepteur sint
                            occaecat cupidatat non proident, sunt in culpa
                            qui officia deserunt mollit anim id est
                            laborum."
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!--/ End Description Tab -->

                <!-- Reviews Tab -->
                <div class="tab-pane fade" id="reviews" role="tabpanel">
                  <div class="tab-single review-panel">
                    <div class="row">
                      <div class="col-12">
                        <!-- Review -->
                        <div class="comment-review">
                          <div class="add-review">
                            <h5>Add A Review</h5>
                            <p>
                              Your email address will not be published.
                              Required fields are marked
                            </p>
                          </div>
                          <h4>
                            Your Rating <span class="text-danger">*</span>
                          </h4>
                          <div class="review-inner">
                            <!-- Form -->
                            @* <form class="form" asp-action="Review" asp-controller="Shop" asp-route-id="@Model.Id">
                              <div class="row">
                              <div class="col-lg-12 col-12">
                              <div class="rating_box">
                              <div class="star-rating">
                              <div class="star-rating__wrap">
                              <input class="star-rating__input" id="star-rating-5" type="radio" name="rate"
                              value=5 />
                              <label class="
                              star-rating__ico
                              fa fa-star-o
                              " for="star-rating-5" title="5 out of 5 stars"></label>
                              <input class="star-rating__input" id="star-rating-4" type="radio" name="rate"
                              value=4 />
                              <label class="
                              star-rating__ico
                              fa fa-star-o
                              " for="star-rating-4" title="4 out of 5 stars"></label>
                              <input class="star-rating__input" id="star-rating-3" type="radio" name="rate"
                              value=3 />
                              <label class="
                              star-rating__ico
                              fa fa-star-o
                              " for="star-rating-3" title="3 out of 5 stars"></label>
                              <input class="star-rating__input" id="star-rating-2" type="radio" name="rate"
                              value=2 />
                              <label class="
                              star-rating__ico
                              fa fa-star-o
                              " for="star-rating-2" title="2 out of 5 stars"></label>
                              <input class="star-rating__input" id="star-rating-1" type="radio" name="rate"
                              value=1 />
                              <label class="
                              star-rating__ico
                              fa fa-star-o
                              " for="star-rating-1" title="1 out of 5 stars"></label>
                              </div>
                              </div>
                              </div>
                              </div>
                              <div class="col-lg-12 col-12">
                              <div class="form-group">
                              <label>Write a review</label>
                              <textarea name="review" rows="6" placeholder=""></textarea>
                              </div>
                              </div>
                              <div class="col-lg-12 col-12">
                              <div class="
                              form-group
                              button5
                              text-center
                              justify-center-between
                              ">
                              <button type="submit" class="btn btn-dark">
                              Submit
                              </button>

                              </div>
                              </div>
                              </div>
                              </form> *@
                            @if (User.Identity.IsAuthenticated)
                            {
                              <form class="form" asp-action="Review" asp-controller="Shop" asp-route-id="@Model.Id">
                                <div class="row">
                                  <div class="col-lg-12 col-12">
                                    <div class="rating_box">
                                      <div class="star-rating">
                                        <div class="star-rating__wrap">
                                          <input class="star-rating__input" id="star-rating-5" type="radio" name="rate"
                                          value=5 />
                                          <label class="
                                                star-rating__ico
                                                fa fa-star-o
                                              " for="star-rating-5" title="5 out of 5 stars"></label>
                                          <input class="star-rating__input" id="star-rating-4" type="radio" name="rate"
                                          value=4 />
                                          <label class="
                                                star-rating__ico
                                                fa fa-star-o
                                              " for="star-rating-4" title="4 out of 5 stars"></label>
                                          <input class="star-rating__input" id="star-rating-3" type="radio" name="rate"
                                          value=3 />
                                          <label class="
                                                star-rating__ico
                                                fa fa-star-o
                                              " for="star-rating-3" title="3 out of 5 stars"></label>
                                          <input class="star-rating__input" id="star-rating-2" type="radio" name="rate"
                                          value=2 />
                                          <label class="
                                                star-rating__ico
                                                fa fa-star-o
                                              " for="star-rating-2" title="2 out of 5 stars"></label>
                                          <input class="star-rating__input" id="star-rating-1" type="radio" name="rate"
                                          value=1 />
                                          <label class="
                                                star-rating__ico
                                                fa fa-star-o
                                              " for="star-rating-1" title="1 out of 5 stars"></label>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="col-lg-12 col-12">
                                    <div class="form-group">
                                      <label>Write a review</label>
                                      <textarea name="review" rows="6" placeholder=""></textarea>
                                    </div>
                                  </div>
                                  <div class="col-lg-12 col-12">
                                    <div class="
                                          form-group
                                          button5
                                          text-center
                                          justify-center-between
                                        ">
                                      <button type="submit" class="btn btn-dark">
                                        Submit
                                      </button>

                                    </div>
                                  </div>
                                </div>
                              </form>

                            }

                            else
                            {
                              <div>
                                <p class="text-center p-5">
                                  You need to
                                  <a asp-area="Identity" asp-page="/Account/Login"
                                  style="color: rgb(54, 54, 204)">Login</a>
                                  OR
                                  <a style="color: blue" asp-area="Identity" asp-page="/Account/Register">Register</a>
                                </p>
                              </div>
                            }
                            <!--/ End Form -->
                          </div>
                        </div>
                        @* <p class="text-center p-5">
                          You need to
                          <a href="#" style="color: rgb(54, 54, 204)">Login</a>
                          OR
                          <a style="color: blue" href="#">Register</a>
                          </p> *@
                        <div class="ratting-main">
                          <div class="avg-ratting">
                            <h4>
                              <span>4 (Overall)</span>
                            </h4>
                            <span>Based on @comment.Count() Comments</span>
                          </div>
                          <!-- Single Rating -->
                          @foreach (var item in comment)

                          {
                            <div class="single-rating">
                              <div class="rating-author">
                                @{

                                  ShopDbContext test = new ShopDbContext();

                                  var photo = test.Users.Find(item.UserId).Photo;

                                  var name = test.Users.Find(item.UserId).Fullname;
                                }
                                @if (photo != null)

                                {
                                  <img src="/storage/@photo" class="content-center">

                                }
                                else
                                {
                                  <img src="/storage/null.jpg" class="content-center">

                                }
                              </div>
                              <div class="rating-des">
                                <h6>@name</h6>
                                <div class="ratings">
                                  <ul class="rating">
                                    @if (item.Rating == 1)

                                    {
                                      @for (var i = 0; i < @item.Rating; i++)

                                      {
                                        <li><i class="fa fa-star"></i></li>

                                      }
                                      @for (var i = 0; i < 5 - @item.Rating; i++)

                                      {
                                        <li><i class="fa fa-star-o"></i></li>

                                      }

                                    }
                                    @if (item.Rating == 2)

                                    {
                                      @for (var i = 0; i < @item.Rating; i++)

                                      {
                                        <li><i class="fa fa-star"></i></li>

                                      }
                                      @for (var i = 0; i < 5 - @item.Rating; i++)

                                      {
                                        <li><i class="fa fa-star-o"></i></li>

                                      }

                                    }
                                    @if (item.Rating == 3)

                                    {
                                      @for (var i = 0; i < @item.Rating; i++)

                                      {
                                        <li><i class="fa fa-star"></i></li>

                                      }
                                      @for (var i = 0; i < 5 - @item.Rating; i++)

                                      {
                                        <li><i class="fa fa-star-o"></i></li>

                                      }

                                    }
                                    @if (item.Rating == 4)

                                    {
                                      @for (var i = 0; i < @item.Rating; i++)

                                      {
                                        <li><i class="fa fa-star"></i></li>

                                      }
                                      @for (var i = 0; i < 5 - @item.Rating; i++)

                                      {
                                        <li><i class="fa fa-star-o"></i></li>

                                      }

                                    }
                                    @if (item.Rating == 5)

                                    {
                                      @for (var i = 0; i < @item.Rating; i++)

                                      {
                                        <li><i class="fa fa-star"></i></li>

                                      }
                                      @for (var i = 0; i < 5 - @item.Rating; i++)

                                      {
                                        <li><i class="fa fa-star-o"></i></li>

                                      }

                                    }
                                  </ul>
                                  <div class="rate-count">
                                    (<span>@item.Rating</span>)
                                  </div>
                                </div>
                                <p>@item.Review</p>
                              </div>
                            </div>

                          }
                          <!--/ End Single Rating -->
                        </div>

                        <!--/ End Review -->
                      </div>
                    </div>
                  </div>
                </div>
                <!--/ End Reviews Tab -->
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>
</section>
<!--/ End Shop Single -->

<script>
  function changeImage(element) {
    var main_prodcut_image = document.getElementById("main_product_image");
    main_prodcut_image.src = element.src;
  }
</script>